这是一份关于ai文档处理的nodejs代码，支持ai编辑器，ai视觉，多文档编辑等功能。使用nodejs语言，在保持这些功能不变的情况下，添加一个基于大模型的导入pdf并转化为markdown与word文件的功能。
大模型调用部分参考ai视觉部分的代码，即\components\OCR\FormulaOCR.tsx的代码。
在网页上多文档处理的按键右方，加入导入pdf的按键。点击后切换到pdf导入界面，点击后弹出文件选择框，选择pdf文件后，调用大模型的接口，将pdf转化为markdown与word文件，将两份文件的预览与pdf源文件在pdf预览窗口中显示。
其中的word预览界面提供下载word文件的功能。


目前的问题是，在pdf导入界面，点击导入pdf后，运行完毕后会跳转到编辑器页面，转化出的markdown与word文件无法预览。需要在pdf导入页面同时预览转化出的markdown与word文件。

在导入pdf后发现pdf中插入的图片无法显示，需要将pdf中的图片提取出来，作为word文件中的图片。markdown文件中可以不显示具体图片，而是添加图片的序号如![图片1]。

存在问题：
1：word的预览中还是看不到图片，只能看到对图片的总结文字说明。
2：在切换到其他功能页面如编辑器时，会清空转化出的markdown与word文件，需要在切换页面时保留转化出的markdown与word文件。
3：pdf上传框太大，展示框太小。将左侧常驻为pdf预览框，右边的框预览转化出的markdown与word文件。且两个框都要在y轴方向上自适应。

现在在word的预览中看不到图片，连对图片的总结文字说明也看不到了，下载下来也看不到图片，markdown文件中看不到图片的序号，修改到可以在word预览中看到图片，下载下来也看到图片，markdown文件中看到图片的序号。


图片识别还是失败，在markdown中已经成功显示图片序号，word预览中看不到图片，下载下来也看不到图片，本来作为图片的为位置显示为：
[图片占位符: ![图片1]，但图片数据缺失]
```markdown

图片可以正常显示，但是存在以下问题：
1：一张图片占位符有两个，即存在![图片1]![图片2].
2：图片占位符之前还是存在对图片的总结文字说明，删除这一部分。
3：图片可以正常显示，但是图片不只是图片，还包括了其他不存在图片中的文字，需要识别出图片真正的区域再提取图片。

这是一份关于ai文档处理的nodejs代码，支持ai编辑器，ai视觉，多文档编辑，pdf导入等功能。
其中pdf导入的功能存在以下问题：
1：图片占位符之前存在对图片的总结文字说明，删除这一部分。
2：图片可以正常显示，但是图片不只是图片，还包括了其他不存在图片中的文字，需要识别出图片真正的区域再提取图片。

在pdf导入功能页面，word预览部分，本来该是图片的位置现在是一片黑白，修复这个问题。

图片可以正常展示，但是图片切割的位置有问题，markdown中对图片的位置是正确的，不使用ai来切割图片，而是访问网站：https://tools.pdf24.org/zh/extract-images使用其中的图像提取功能，
或者提供其他modejs语言可以使用的pdf图像提取功能。

word预览显示为[图片占位符: ![图片1]，但图片数据缺失]

我需要使用pdf.js库提取的pdf中的图片，不需要整个页面的图，修复这个问题。

完美，所有功能都已经齐全，现在只有两个小要求：
1：将功能页中的“pdf导入”改名为“pdf分析”
2：pdf识别公式成功，在markdown中成功显示公式，但是word预览中显示与markdown的相同，没有显示出公式。例如在markdown中显示$$e^{i\pi} + 1 = 0$$，在word中也一样而不是可视化公式，修改为可视化公式。

word预览显示中还是没有可视化公式，参考编辑器(editor)中的公式显示方式，修复bug。

公式显示正常了，但是图片显示又有问题，只显示了占位符![图片1]。在图片展示部分回退到上一版本代码，修复bug。